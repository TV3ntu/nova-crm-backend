# 🚀 NOVA Dance Studio CRM - Render Deployment Guide

## 📋 Prerequisites
- GitHub repository with your code
- Render account (free tier available)
- Docker configuration (included)

## 🔧 Render Deployment Steps

### 1. **Prepare Your Repository**
Ensure these files are in your repository:
- ✅ `render.yaml` - Render service configuration
- ✅ `Dockerfile` - Docker container configuration
- ✅ `.dockerignore` - Docker build optimization
- ✅ `gradlew` - Gradle wrapper (executable)
- ✅ All source code and configurations

### 2. **Deploy to Render**

#### Using render.yaml with Docker (Recommended)
1. **Push to GitHub:**
   ```bash
   git add .
   git commit -m "Add Render Docker deployment configuration"
   git push origin master
   ```

2. **Connect to Render:**
   - Go to [render.com](https://render.com)
   - Click "New +" → "Blueprint"
   - Connect your GitHub repository
   - Render will automatically detect `render.yaml` and `Dockerfile`
   - Click "Apply" to create services

### 3. **Environment Variables**
Render will automatically create these from `render.yaml`:

#### Auto-Generated Variables:
```bash
SPRING_PROFILES_ACTIVE=prod
DATABASE_URL=<auto-populated by Render PostgreSQL>
JWT_SECRET=<auto-generated secure value>
ADMIN_PASSWORD=<auto-generated secure value>
SWAGGER_ENABLED=false
API_DOCS_ENABLED=false
```

#### ⚠️ **Important:** Save the auto-generated passwords!
After deployment, go to your web service → Environment tab to see the generated `ADMIN_PASSWORD`.

### 4. **Docker Configuration Details**

The included `Dockerfile` provides:
- ✅ **Multi-stage build** for optimized image size
- ✅ **Java 17** runtime environment
- ✅ **Non-root user** for security
- ✅ **Health checks** built-in
- ✅ **Port configuration** for Render

## 🔗 **Render Configuration Details**

### render.yaml Configuration:
- **Environment:** Docker (not Java native)
- **Build:** Automatic Docker build
- **Health Check:** `/api/auth/login`
- **Plan:** Free tier
- **Region:** Oregon

### Database Configuration:
- **PostgreSQL 14+** (Render managed)
- **Connection:** Auto-configured via `DATABASE_URL`
- **Backups:** Included in free tier
- **SSL:** Enabled by default

## 🌐 **Access Your Application**

After successful deployment:
- **Application URL:** `https://nova-crm-xxxx.onrender.com`
- **API Base:** `https://nova-crm-xxxx.onrender.com/api`
- **Health Check:** `https://nova-crm-xxxx.onrender.com/api/auth/login`

## 🔐 **First Time Setup**

1. **Get Admin Password:**
   - Go to Render Dashboard → Your Web Service → Environment
   - Find the auto-generated `ADMIN_PASSWORD` value
   - Save it securely!

2. **Test Authentication:**
   ```bash
   curl -X POST https://your-app.onrender.com/api/auth/login \
     -H "Content-Type: application/json" \
     -d '{"username":"admin","password":"YOUR_GENERATED_PASSWORD"}'
   ```

3. **Get JWT Token** from response and use for API calls:
   ```bash
   curl -H "Authorization: Bearer YOUR_JWT_TOKEN" \
     https://your-app.onrender.com/api/students
   ```

## 📊 **Monitoring & Logs**

### Render Dashboard:
- **Logs:** Real-time Docker container logs
- **Metrics:** CPU, Memory, Response times
- **Health:** Service status and uptime
- **Database:** Connection stats and queries

### Docker Health Checks:
- Automatic health monitoring every 30 seconds
- Restart on failure
- Startup grace period of 60 seconds

## 🚨 **Troubleshooting**

### Common Issues:

1. **Docker Build Fails:**
   ```bash
   # Ensure gradlew is executable
   chmod +x gradlew
   git add gradlew
   git commit -m "Fix gradlew permissions"
   git push
   ```

2. **Database Connection Error:**
   - Verify PostgreSQL service is created
   - Check both services are in same region
   - Database URL is auto-populated by Render

3. **Application Won't Start:**
   - Check Docker logs in Render dashboard
   - Verify PORT environment variable is used
   - Ensure health check endpoint is accessible

4. **Can't Access Admin:**
   - Check Environment variables in Render dashboard
   - Use the auto-generated ADMIN_PASSWORD
   - Username is always "admin"

### Performance Tips:
- Docker builds are cached for faster deployments
- Use **Starter** plan for production (more resources)
- Enable **Auto-Deploy** for continuous deployment

## 🔄 **Continuous Deployment**

Render automatically rebuilds and deploys when you push to your master branch:
```bash
git add .
git commit -m "Update application"
git push origin master
# Render will automatically build Docker image and deploy
```

## 💰 **Cost Estimation**

### Free Tier (Development):
- **Web Service:** Free (Docker containers included)
- **PostgreSQL:** Free (1GB storage)
- **Total:** $0/month

### Production Ready:
- **Web Service:** $7/month (Starter plan)
- **PostgreSQL:** $7/month (Starter plan)
- **Total:** $14/month

## 🎉 **You're Ready!**

Your NOVA Dance Studio CRM is now configured for Render deployment with:
- ✅ Docker containerization
- ✅ Automatic builds and deployments
- ✅ Managed PostgreSQL database
- ✅ SSL certificates
- ✅ Environment variable management
- ✅ Health monitoring
- ✅ Scalable infrastructure

Just push your code to GitHub and deploy! 🚀
